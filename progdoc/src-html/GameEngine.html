<!DOCTYPE HTML>
<html lang="fr">
<head>
<!-- Generated by javadoc (17) -->
<title>Source code</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="source: class: GameEngine">
<meta name="generator" content="javadoc/SourceToHTMLConverter">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
</head>
<body class="source-page">
<main role="main">
<div class="source-container">
<pre><span class="source-line-no">001</span><span id="line-1">import java.io.File;</span>
<span class="source-line-no">002</span><span id="line-2">import java.io.FileNotFoundException;</span>
<span class="source-line-no">003</span><span id="line-3">import java.util.Scanner;</span>
<span class="source-line-no">004</span><span id="line-4"></span>
<span class="source-line-no">005</span><span id="line-5">/**</span>
<span class="source-line-no">006</span><span id="line-6"> * Decrivez votre classe GameEngine ici.</span>
<span class="source-line-no">007</span><span id="line-7"> *</span>
<span class="source-line-no">008</span><span id="line-8"> * @author (votre nom)</span>
<span class="source-line-no">009</span><span id="line-9"> * @version (un numero de version ou une date)</span>
<span class="source-line-no">010</span><span id="line-10"> */</span>
<span class="source-line-no">011</span><span id="line-11">public class GameEngine {</span>
<span class="source-line-no">012</span><span id="line-12">    /** le nombre maximum de commandes */</span>
<span class="source-line-no">013</span><span id="line-13">    private static final int MAXNBRCMD = 100;</span>
<span class="source-line-no">014</span><span id="line-14">    /** le joueur */</span>
<span class="source-line-no">015</span><span id="line-15">    private Player aPlayer;</span>
<span class="source-line-no">016</span><span id="line-16">    /** le parser qui analyse les commandes */</span>
<span class="source-line-no">017</span><span id="line-17">    private Parser aParser;</span>
<span class="source-line-no">018</span><span id="line-18">    /** l'interface utilisateur */</span>
<span class="source-line-no">019</span><span id="line-19">    private UserInterface aGui;</span>
<span class="source-line-no">020</span><span id="line-20"></span>
<span class="source-line-no">021</span><span id="line-21">    /**</span>
<span class="source-line-no">022</span><span id="line-22">     * Constructeur d'objets de classe GameEngine</span>
<span class="source-line-no">023</span><span id="line-23">     */</span>
<span class="source-line-no">024</span><span id="line-24">    public GameEngine()</span>
<span class="source-line-no">025</span><span id="line-25">    {</span>
<span class="source-line-no">026</span><span id="line-26">        // String vPrenom = javax.swing.JOptionPane.showInputDialog( "What's your name?" );</span>
<span class="source-line-no">027</span><span id="line-27">        // this.aPlayer = new Player( vPrenom );</span>
<span class="source-line-no">028</span><span id="line-28">        this.aPlayer = new Player( );</span>
<span class="source-line-no">029</span><span id="line-29">        this.createRooms();</span>
<span class="source-line-no">030</span><span id="line-30">        this.aParser = new Parser();</span>
<span class="source-line-no">031</span><span id="line-31">    }</span>
<span class="source-line-no">032</span><span id="line-32"></span>
<span class="source-line-no">033</span><span id="line-33">    /**</span>
<span class="source-line-no">034</span><span id="line-34">     * Setter pour l'interface utilisateur.</span>
<span class="source-line-no">035</span><span id="line-35">     * @param pUserInterface interface utilisateur</span>
<span class="source-line-no">036</span><span id="line-36">     */</span>
<span class="source-line-no">037</span><span id="line-37">    public void setGUI( final UserInterface pUserInterface )</span>
<span class="source-line-no">038</span><span id="line-38">    {</span>
<span class="source-line-no">039</span><span id="line-39">        this.aGui = pUserInterface;</span>
<span class="source-line-no">040</span><span id="line-40">        this.printWelcome();</span>
<span class="source-line-no">041</span><span id="line-41">    }</span>
<span class="source-line-no">042</span><span id="line-42"></span>
<span class="source-line-no">043</span><span id="line-43">    /**</span>
<span class="source-line-no">044</span><span id="line-44">     * Initialiser les salles, les sorties et la position actuelle du joueur.</span>
<span class="source-line-no">045</span><span id="line-45">     */</span>
<span class="source-line-no">046</span><span id="line-46">    private void createRooms() {</span>
<span class="source-line-no">047</span><span id="line-47">        Room vOutside = new Room(</span>
<span class="source-line-no">048</span><span id="line-48">                "standing outside the secret laboratory, \nthe entrance looming ahead with an air of mystery and danger.","entrance.jpg");</span>
<span class="source-line-no">049</span><span id="line-49">        Room vStorage = new Room(</span>
<span class="source-line-no">050</span><span id="line-50">                "in a cluttered storage room, \nfilled with various discarded objects and tools.","storage.jpg");</span>
<span class="source-line-no">051</span><span id="line-51">        Room vClean = new Room(</span>
<span class="source-line-no">052</span><span id="line-52">                "in the clean room, \na sterile area where disinfection and changing take place. \nThe air smells faintly of chemicals, \nand a row of lockers lines the wall.","clean.jpg");</span>
<span class="source-line-no">053</span><span id="line-53">        Room vMeeting = new Room(</span>
<span class="source-line-no">054</span><span id="line-54">                "in the meeting room, \nwhere scientists plan their experiments. \nA large table and chairs dominate the space, \nand diagrams cover the walls.","meeting.jpg");</span>
<span class="source-line-no">055</span><span id="line-55">        Room vPrison = new Room(</span>
<span class="source-line-no">056</span><span id="line-56">                "in the prison room, \nwhere human subjects are held in confinement. \nThe air feels heavy with tension.","prison.jpg");</span>
<span class="source-line-no">057</span><span id="line-57">        Room vAnimal = new Room(</span>
<span class="source-line-no">058</span><span id="line-58">                "in the animal room, a isolated space \nwhere animals, transformed by experiments, are kept in cages. \nThe room is eerily quiet.","animal.jpg");</span>
<span class="source-line-no">059</span><span id="line-59">        Room vArchive = new Room(</span>
<span class="source-line-no">060</span><span id="line-60">                " in the archive room, a space \nfilled with shelves of files and records. \nEach document holds secrets about the experiments conducted here.","archive.jpg");</span>
<span class="source-line-no">061</span><span id="line-61">        Room vExperimentation = new Room(</span>
<span class="source-line-no">062</span><span id="line-62">                "in the experimentation room, \nwhere the darkest of the laboratory's procedures are carried out. \nSurgical beds and strange equipment fill the space.","exprience.png");</span>
<span class="source-line-no">063</span><span id="line-63">        Room vGarden = new Room(</span>
<span class="source-line-no">064</span><span id="line-64">                "in a garden, with flowers blooming beautifully \nbut with a rancid smell.","garden.jpg");</span>
<span class="source-line-no">065</span><span id="line-65">        Room vAleatoire = vAnimal; // random room, pas encore fait</span>
<span class="source-line-no">066</span><span id="line-66"></span>
<span class="source-line-no">067</span><span id="line-67">        vOutside.setExits("south", vStorage);</span>
<span class="source-line-no">068</span><span id="line-68">        vOutside.addItem("an old pair of glasses without lenses. Wearing it can make you see things differently", 40,"glasses",true,true);  // 40 is the weight of the item</span>
<span class="source-line-no">069</span><span id="line-69"></span>
<span class="source-line-no">070</span><span id="line-70">        vStorage.setExits("down", vClean);</span>
<span class="source-line-no">071</span><span id="line-71">        vStorage.setExits("north", vOutside);</span>
<span class="source-line-no">072</span><span id="line-72">        vStorage.addItem("a key for the cabinet in the archives room", 60,"key",true,true);</span>
<span class="source-line-no">073</span><span id="line-73">        vStorage.addItem("an invisible cloth can help you hide", 50,"cloth",true,false);</span>
<span class="source-line-no">074</span><span id="line-74">        vStorage.addItem("a torn piece of paper with the name Alice", 2,"paper",false,true);</span>
<span class="source-line-no">075</span><span id="line-75">        vStorage.addItem("a plan of the entire laboratory but broken", 10,"plan",false,true);</span>
<span class="source-line-no">076</span><span id="line-76"></span>
<span class="source-line-no">077</span><span id="line-77">        vClean.setExits("west", vMeeting);</span>
<span class="source-line-no">078</span><span id="line-78">        vClean.setExits("south", vAleatoire);</span>
<span class="source-line-no">079</span><span id="line-79">        vClean.setExits("up", vStorage);</span>
<span class="source-line-no">080</span><span id="line-80">        vClean.addItem("an access card for the experiment room",50,"card",true,true);</span>
<span class="source-line-no">081</span><span id="line-81">        vClean.addItem("a magic cake that can increase your maximum ability to take things by 20% after eating it", 60,"magicCake",true,false);</span>
<span class="source-line-no">082</span><span id="line-82">        </span>
<span class="source-line-no">083</span><span id="line-83">        vMeeting.setExits("east", vClean);</span>
<span class="source-line-no">084</span><span id="line-84">        vMeeting.setExits("west", vArchive);</span>
<span class="source-line-no">085</span><span id="line-85">        vMeeting.setExits("south", vPrison);</span>
<span class="source-line-no">086</span><span id="line-86">        vMeeting.addItem("a whiteboard displays a discussion about which animal to place 2566's soul into, along with a prominent slogan",500,"whiteboard",false,true);</span>
<span class="source-line-no">087</span><span id="line-87"></span>
<span class="source-line-no">088</span><span id="line-88">        vPrison.setExits("north", vMeeting);</span>
<span class="source-line-no">089</span><span id="line-89">        vPrison.setExits("west", vGarden);</span>
<span class="source-line-no">090</span><span id="line-90"></span>
<span class="source-line-no">091</span><span id="line-91">        vGarden.setExits("east", vPrison);</span>
<span class="source-line-no">092</span><span id="line-92"></span>
<span class="source-line-no">093</span><span id="line-93">        vAnimal.setExits("west", vExperimentation);</span>
<span class="source-line-no">094</span><span id="line-94">        vAnimal.setExits("south", vMeeting);</span>
<span class="source-line-no">095</span><span id="line-95">        vAnimal.addItem("an empty cage with a small plastic tag labeled 2566", 300,"cage",false,true);</span>
<span class="source-line-no">096</span><span id="line-96"></span>
<span class="source-line-no">097</span><span id="line-97">        vArchive.setExits("east", vMeeting);</span>
<span class="source-line-no">098</span><span id="line-98">        vArchive.setExits("north", vExperimentation);</span>
<span class="source-line-no">099</span><span id="line-99">        vArchive.setExits("south", vGarden);</span>
<span class="source-line-no">100</span><span id="line-100">        vArchive.addItem("a cabinet with a lock", 900,"cabinet",false,true);</span>
<span class="source-line-no">101</span><span id="line-101">        //attends key open cabinet</span>
<span class="source-line-no">102</span><span id="line-102">        //"You use the key to open the cabinet and find a lot of \nexperimenter information, sorted by name. You easily find \nAlice's information and find that her name and photo are \nthe same as your missing sister. You also find that the latest information \nindicates that she will be sent to the laboratory within a week. \nWhen flipping through the information, you find that the \nearliest information about this laboratory appears in 2050. \nYou suspect that this is the year the laboratory was founded. \nA piece of paper with August 9, 2050 written on it falls \nfrom the book, proving your guess."</span>
<span class="source-line-no">103</span><span id="line-103"></span>
<span class="source-line-no">104</span><span id="line-104">        vExperimentation.setExits("east", vAnimal);</span>
<span class="source-line-no">105</span><span id="line-105">        vExperimentation.setExits("south", vArchive);</span>
<span class="source-line-no">106</span><span id="line-106">        vExperimentation.addItem("a bed with a small sign saying 2566", 300,"bed",false,true);</span>
<span class="source-line-no">107</span><span id="line-107"></span>
<span class="source-line-no">108</span><span id="line-108">        aPlayer.setCurrentRoom(vOutside);</span>
<span class="source-line-no">109</span><span id="line-109">    }</span>
<span class="source-line-no">110</span><span id="line-110"></span>
<span class="source-line-no">111</span><span id="line-111">    /**</span>
<span class="source-line-no">112</span><span id="line-112">     * Deplacer le joueur dans une direction donnee.</span>
<span class="source-line-no">113</span><span id="line-113">     * @param pCmd commande a traiter</span>
<span class="source-line-no">114</span><span id="line-114">     */</span>
<span class="source-line-no">115</span><span id="line-115">    private void goRoom(final Command pCmd) {</span>
<span class="source-line-no">116</span><span id="line-116">        if (!pCmd.hasSecondWord()) {</span>
<span class="source-line-no">117</span><span id="line-117">            this.aGui.println("Go where ?");</span>
<span class="source-line-no">118</span><span id="line-118">            return;</span>
<span class="source-line-no">119</span><span id="line-119">        }</span>
<span class="source-line-no">120</span><span id="line-120">        String vDirection = pCmd.getSecondWord();</span>
<span class="source-line-no">121</span><span id="line-121">        Room vNextRoom = this.aPlayer.getCurrentRoom().getExit(vDirection);</span>
<span class="source-line-no">122</span><span id="line-122">        if(vNextRoom==null){</span>
<span class="source-line-no">123</span><span id="line-123">            this.aGui.println("There is no door !");</span>
<span class="source-line-no">124</span><span id="line-124">        } else{</span>
<span class="source-line-no">125</span><span id="line-125">            if(!vNextRoom.isExit(this.aPlayer.getCurrentRoom()))</span>
<span class="source-line-no">126</span><span id="line-126">                this.aPlayer.removeAllPreviousRooms();</span>
<span class="source-line-no">127</span><span id="line-127">            this.aPlayer.addPreviousRoom(this.aPlayer.getCurrentRoom());//Pushes a new element on top of this Stack.</span>
<span class="source-line-no">128</span><span id="line-128">            this.aPlayer.setCurrentRoom(vNextRoom);</span>
<span class="source-line-no">129</span><span id="line-129">            this.aPlayer.setNbrCmdAddOne();</span>
<span class="source-line-no">130</span><span id="line-130">        }</span>
<span class="source-line-no">131</span><span id="line-131">        if (!this.limiteCmd()) this.printLocationInfo();</span>
<span class="source-line-no">132</span><span id="line-132">    }</span>
<span class="source-line-no">133</span><span id="line-133"></span>
<span class="source-line-no">134</span><span id="line-134">    /**</span>
<span class="source-line-no">135</span><span id="line-135">     * Deplacer le joueur dans la salle precedante.</span>
<span class="source-line-no">136</span><span id="line-136">     * @param pCmd commande a traiter</span>
<span class="source-line-no">137</span><span id="line-137">     */</span>
<span class="source-line-no">138</span><span id="line-138">    private void back(final Command pCmd) {</span>
<span class="source-line-no">139</span><span id="line-139">        if (pCmd.hasSecondWord()) {</span>
<span class="source-line-no">140</span><span id="line-140">            this.aGui.println("You cannot specify a direction when going back.");</span>
<span class="source-line-no">141</span><span id="line-141">            return;</span>
<span class="source-line-no">142</span><span id="line-142">        }else if(this.aPlayer.PreviousRoomIsEmpty()){</span>
<span class="source-line-no">143</span><span id="line-143">            this.aGui.println("There's nowhere you can go back to.");</span>
<span class="source-line-no">144</span><span id="line-144">            return;</span>
<span class="source-line-no">145</span><span id="line-145">        }else if(!this.aPlayer.getCurrentRoom().isExit(this.aPlayer.getPreviousRoom())){</span>
<span class="source-line-no">146</span><span id="line-146">            this.aGui.println("You can't back on the one-way road.");</span>
<span class="source-line-no">147</span><span id="line-147">            return;</span>
<span class="source-line-no">148</span><span id="line-148">        }</span>
<span class="source-line-no">149</span><span id="line-149">        Room vNextRoom = this.aPlayer.getPreviousRoom();//Returns the head element without modifying the Stack.</span>
<span class="source-line-no">150</span><span id="line-150">        this.aPlayer.setCurrentRoom(vNextRoom);</span>
<span class="source-line-no">151</span><span id="line-151">        this.aPlayer.removePreviousRoom();//Removes the head element from this Stack.</span>
<span class="source-line-no">152</span><span id="line-152">        this.printLocationInfo();</span>
<span class="source-line-no">153</span><span id="line-153">        this.aPlayer.setNbrCmdAddOne();</span>
<span class="source-line-no">154</span><span id="line-154">        this.limiteCmd();</span>
<span class="source-line-no">155</span><span id="line-155">    }</span>
<span class="source-line-no">156</span><span id="line-156"></span>
<span class="source-line-no">157</span><span id="line-157">    /**</span>
<span class="source-line-no">158</span><span id="line-158">     * Afficher les informations localisation de salle actuel.</span>
<span class="source-line-no">159</span><span id="line-159">     */</span>
<span class="source-line-no">160</span><span id="line-160">    private void printLocationInfo() {</span>
<span class="source-line-no">161</span><span id="line-161">        this.aGui.println(this.aPlayer.getCurrentRoom().getLongDescription(this.aPlayer));</span>
<span class="source-line-no">162</span><span id="line-162">        if ( this.aPlayer.getCurrentRoom().getImgName() != null )</span>
<span class="source-line-no">163</span><span id="line-163">            this.aGui.showImage( this.aPlayer.getCurrentRoom().getImgName() );</span>
<span class="source-line-no">164</span><span id="line-164">    }</span>
<span class="source-line-no">165</span><span id="line-165"></span>
<span class="source-line-no">166</span><span id="line-166">    /**</span>
<span class="source-line-no">167</span><span id="line-167">     * Afficher les informations de bienvenue et les informations de la position actuelle.</span>
<span class="source-line-no">168</span><span id="line-168">     */</span>
<span class="source-line-no">169</span><span id="line-169">    private void printWelcome() {</span>
<span class="source-line-no">170</span><span id="line-170">        this.aGui.println("\nWelcome to the Secret of the Cat!\n"</span>
<span class="source-line-no">171</span><span id="line-171">                + "Secret of the Cat is a new, incredibly boring adventure game.\n"</span>
<span class="source-line-no">172</span><span id="line-172">                + "Type 'help' if you need help.\n");</span>
<span class="source-line-no">173</span><span id="line-173">        this.printLocationInfo();</span>
<span class="source-line-no">174</span><span id="line-174">    }</span>
<span class="source-line-no">175</span><span id="line-175"></span>
<span class="source-line-no">176</span><span id="line-176">    /**</span>
<span class="source-line-no">177</span><span id="line-177">     * Afficher les informations d'aide.</span>
<span class="source-line-no">178</span><span id="line-178">     */</span>
<span class="source-line-no">179</span><span id="line-179">    private void printHelp() {</span>
<span class="source-line-no">180</span><span id="line-180">        this.aGui.println("You are lost. You are alone.\n"</span>
<span class="source-line-no">181</span><span id="line-181">                + "You wander around at the laboratory.\n\n"</span>
<span class="source-line-no">182</span><span id="line-182">                + "Your command words are:" + this.aParser.getCommands() + "\n"</span>
<span class="source-line-no">183</span><span id="line-183">                + "!!! You can only use 100 times the following commands: 'go', 'back', 'take' and 'drop'!!!\n");</span>
<span class="source-line-no">184</span><span id="line-184">    }</span>
<span class="source-line-no">185</span><span id="line-185"></span>
<span class="source-line-no">186</span><span id="line-186">    /**</span>
<span class="source-line-no">187</span><span id="line-187">     * traiter la commande quit.</span>
<span class="source-line-no">188</span><span id="line-188">     * @param pCmd commande a traiter</span>
<span class="source-line-no">189</span><span id="line-189">     */</span>
<span class="source-line-no">190</span><span id="line-190">    private void quit(final Command pCmd) {</span>
<span class="source-line-no">191</span><span id="line-191">        if (pCmd.hasSecondWord()) {</span>
<span class="source-line-no">192</span><span id="line-192">            this.aGui.println("Quit can't be followed by a second word.");</span>
<span class="source-line-no">193</span><span id="line-193">        }else {</span>
<span class="source-line-no">194</span><span id="line-194">            this.aGui.println("Thank you for playing.  Good bye.");</span>
<span class="source-line-no">195</span><span id="line-195">            this.aGui.enable(false);</span>
<span class="source-line-no">196</span><span id="line-196">        }</span>
<span class="source-line-no">197</span><span id="line-197">    }</span>
<span class="source-line-no">198</span><span id="line-198"></span>
<span class="source-line-no">199</span><span id="line-199">    /**</span>
<span class="source-line-no">200</span><span id="line-200">     * Traiter la commande du joueur.</span>
<span class="source-line-no">201</span><span id="line-201">     * @param pCmd commande a traiter</span>
<span class="source-line-no">202</span><span id="line-202">     */</span>
<span class="source-line-no">203</span><span id="line-203">    public void interpretCommand(final String pCmd) {</span>
<span class="source-line-no">204</span><span id="line-204"></span>
<span class="source-line-no">205</span><span id="line-205">        this.aGui.println( "&gt; " + pCmd );</span>
<span class="source-line-no">206</span><span id="line-206">        Command vCmd = this.aParser.getCommand( pCmd );</span>
<span class="source-line-no">207</span><span id="line-207"></span>
<span class="source-line-no">208</span><span id="line-208">        if (vCmd.isUnknown()) {</span>
<span class="source-line-no">209</span><span id="line-209">            this.aGui.println("Erreur du programmeur : commande non reconnue !");</span>
<span class="source-line-no">210</span><span id="line-210">            return;</span>
<span class="source-line-no">211</span><span id="line-211">        } else if (vCmd.getCommandWord().equals("go")) {</span>
<span class="source-line-no">212</span><span id="line-212">            this.goRoom(vCmd);</span>
<span class="source-line-no">213</span><span id="line-213">            // nbrCmd+1</span>
<span class="source-line-no">214</span><span id="line-214">        } else if (vCmd.getCommandWord().equals("quit")) {</span>
<span class="source-line-no">215</span><span id="line-215">            this.quit(vCmd);</span>
<span class="source-line-no">216</span><span id="line-216">        } else if (vCmd.getCommandWord().equals("help")) {</span>
<span class="source-line-no">217</span><span id="line-217">            this.printHelp();</span>
<span class="source-line-no">218</span><span id="line-218">        } else if (vCmd.getCommandWord().equals("look")) {</span>
<span class="source-line-no">219</span><span id="line-219">            this.look(vCmd);</span>
<span class="source-line-no">220</span><span id="line-220">        } else if (vCmd.getCommandWord().equals("eat")) {</span>
<span class="source-line-no">221</span><span id="line-221">            this.eat(vCmd);</span>
<span class="source-line-no">222</span><span id="line-222">        } else if (vCmd.getCommandWord().equals("back")) {</span>
<span class="source-line-no">223</span><span id="line-223">            this.back(vCmd);</span>
<span class="source-line-no">224</span><span id="line-224">            // nbrCmd+1</span>
<span class="source-line-no">225</span><span id="line-225">        } else if (vCmd.getCommandWord().equals("test")) {</span>
<span class="source-line-no">226</span><span id="line-226">            this.test(vCmd);</span>
<span class="source-line-no">227</span><span id="line-227">        } else if (vCmd.getCommandWord().equals("take")) {</span>
<span class="source-line-no">228</span><span id="line-228">            this.take(vCmd);</span>
<span class="source-line-no">229</span><span id="line-229">            // nbrCmd+1</span>
<span class="source-line-no">230</span><span id="line-230">        } else if (vCmd.getCommandWord().equals("drop")) {</span>
<span class="source-line-no">231</span><span id="line-231">            this.drop(vCmd);</span>
<span class="source-line-no">232</span><span id="line-232">            // nbrCmd+1</span>
<span class="source-line-no">233</span><span id="line-233">        } else if (vCmd.getCommandWord().equals("items")) {</span>
<span class="source-line-no">234</span><span id="line-234">            this.items(vCmd);</span>
<span class="source-line-no">235</span><span id="line-235">        } else {</span>
<span class="source-line-no">236</span><span id="line-236">            this.aGui.println("I don't know what you mean...");</span>
<span class="source-line-no">237</span><span id="line-237">        }</span>
<span class="source-line-no">238</span><span id="line-238">    }</span>
<span class="source-line-no">239</span><span id="line-239"></span>
<span class="source-line-no">240</span><span id="line-240">    /**</span>
<span class="source-line-no">241</span><span id="line-241">     * Afficher les informations de la salle actuelle et les objets dans joueur.</span>
<span class="source-line-no">242</span><span id="line-242">     * @param pCmd commande a traiter </span>
<span class="source-line-no">243</span><span id="line-243">     */</span>
<span class="source-line-no">244</span><span id="line-244">    private void look(final Command pCmd){</span>
<span class="source-line-no">245</span><span id="line-245">        if (pCmd.hasSecondWord()) {</span>
<span class="source-line-no">246</span><span id="line-246">            String vItemName=pCmd.getSecondWord();</span>
<span class="source-line-no">247</span><span id="line-247">            Item vItem = this.aPlayer.getCurrentRoom().getOneItem(vItemName);</span>
<span class="source-line-no">248</span><span id="line-248">            if(vItem==null){</span>
<span class="source-line-no">249</span><span id="line-249">                this.aGui.println("The item you are looking for is not in this room.");</span>
<span class="source-line-no">250</span><span id="line-250">                return;</span>
<span class="source-line-no">251</span><span id="line-251">            }</span>
<span class="source-line-no">252</span><span id="line-252">            this.aGui.println("There is "+vItem.getItemDescription()+".");</span>
<span class="source-line-no">253</span><span id="line-253">            return;</span>
<span class="source-line-no">254</span><span id="line-254">        }</span>
<span class="source-line-no">255</span><span id="line-255">        this.aGui.println(this.aPlayer.getCurrentRoom().getLongDescription(this.aPlayer)+"\n");</span>
<span class="source-line-no">256</span><span id="line-256">    }</span>
<span class="source-line-no">257</span><span id="line-257"></span>
<span class="source-line-no">258</span><span id="line-258">    /**</span>
<span class="source-line-no">259</span><span id="line-259">     * Manger un objet.</span>
<span class="source-line-no">260</span><span id="line-260">     * @param pCmd commande a traiter</span>
<span class="source-line-no">261</span><span id="line-261">     */</span>
<span class="source-line-no">262</span><span id="line-262">    private void eat(final Command pCmd){</span>
<span class="source-line-no">263</span><span id="line-263">        if (!pCmd.hasSecondWord()) {</span>
<span class="source-line-no">264</span><span id="line-264">            this.aGui.println("Eat what?");</span>
<span class="source-line-no">265</span><span id="line-265">            return;</span>
<span class="source-line-no">266</span><span id="line-266">        }</span>
<span class="source-line-no">267</span><span id="line-267">        if(pCmd.getSecondWord().equals("magicCake")){</span>
<span class="source-line-no">268</span><span id="line-268">            if(this.aPlayer.hasItem("magicCake")){</span>
<span class="source-line-no">269</span><span id="line-269">                this.aPlayer.removeItem("magicCake");</span>
<span class="source-line-no">270</span><span id="line-270">                this.aPlayer.setWeightAllowed(120);</span>
<span class="source-line-no">271</span><span id="line-271">                this.aGui.println("You have eaten the magic cake and now you have "+this.aPlayer.getWeightAllowed()+"% capacity to carry things.");</span>
<span class="source-line-no">272</span><span id="line-272">            }else{</span>
<span class="source-line-no">273</span><span id="line-273">                this.aGui.println("You don't have the magic cake.");</span>
<span class="source-line-no">274</span><span id="line-274">                return;</span>
<span class="source-line-no">275</span><span id="line-275">            }</span>
<span class="source-line-no">276</span><span id="line-276">        }</span>
<span class="source-line-no">277</span><span id="line-277">        else</span>
<span class="source-line-no">278</span><span id="line-278">            this.aGui.println("You have eaten a food imaginary, you are not hungry anymore.");</span>
<span class="source-line-no">279</span><span id="line-279">    }</span>
<span class="source-line-no">280</span><span id="line-280"></span>
<span class="source-line-no">281</span><span id="line-281">    /**</span>
<span class="source-line-no">282</span><span id="line-282">     * Tester les commandes dans un fichier.</span>
<span class="source-line-no">283</span><span id="line-283">     * @param pCmd commande a traiter qui a le nom du fichier comme second mot</span>
<span class="source-line-no">284</span><span id="line-284">     */</span>
<span class="source-line-no">285</span><span id="line-285">    private void test(final Command pCmd){</span>
<span class="source-line-no">286</span><span id="line-286">        if (!pCmd.hasSecondWord()) {</span>
<span class="source-line-no">287</span><span id="line-287">            this.aGui.println("Test what?");</span>
<span class="source-line-no">288</span><span id="line-288">            return;</span>
<span class="source-line-no">289</span><span id="line-289">        }</span>
<span class="source-line-no">290</span><span id="line-290">        Scanner vSc=null;</span>
<span class="source-line-no">291</span><span id="line-291">        try { // pour "essayer" les instructions suivantes :</span>
<span class="source-line-no">292</span><span id="line-292">            vSc = new Scanner( new File( pCmd.getSecondWord()+".txt" ) ); // ouverture du fichier s'il existe</span>
<span class="source-line-no">293</span><span id="line-293">            while ( vSc.hasNextLine() ) { // tant qu'il y a encore une ligne a lire dans le fichier</span>
<span class="source-line-no">294</span><span id="line-294">                interpretCommand(vSc.nextLine()); // lecture de la ligne dans le fichier</span>
<span class="source-line-no">295</span><span id="line-295">                /// traitement de la ligne lue</span>
<span class="source-line-no">296</span><span id="line-296">            } // while</span>
<span class="source-line-no">297</span><span id="line-297">        } // try</span>
<span class="source-line-no">298</span><span id="line-298">        catch ( final FileNotFoundException pFNFE ) { // si le fichier n'existe pas</span>
<span class="source-line-no">299</span><span id="line-299">            /// traitement en cas d'exception</span>
<span class="source-line-no">300</span><span id="line-300">        } // catch</span>
<span class="source-line-no">301</span><span id="line-301">        finally</span>
<span class="source-line-no">302</span><span id="line-302">        {</span>
<span class="source-line-no">303</span><span id="line-303">            if(vSc !=null)</span>
<span class="source-line-no">304</span><span id="line-304">            {</span>
<span class="source-line-no">305</span><span id="line-305">                vSc.close();</span>
<span class="source-line-no">306</span><span id="line-306">                return;</span>
<span class="source-line-no">307</span><span id="line-307">            }</span>
<span class="source-line-no">308</span><span id="line-308">        }</span>
<span class="source-line-no">309</span><span id="line-309">    }</span>
<span class="source-line-no">310</span><span id="line-310"></span>
<span class="source-line-no">311</span><span id="line-311">    /**</span>
<span class="source-line-no">312</span><span id="line-312">     * Prendre un objet.</span>
<span class="source-line-no">313</span><span id="line-313">     * @param pCmd commande a traiter</span>
<span class="source-line-no">314</span><span id="line-314">     */</span>
<span class="source-line-no">315</span><span id="line-315">    private void take(final Command pCmd){</span>
<span class="source-line-no">316</span><span id="line-316">        if (!pCmd.hasSecondWord()) {</span>
<span class="source-line-no">317</span><span id="line-317">            this.aGui.println("Take what?");</span>
<span class="source-line-no">318</span><span id="line-318">            return;</span>
<span class="source-line-no">319</span><span id="line-319">        }</span>
<span class="source-line-no">320</span><span id="line-320">        String vItemName = pCmd.getSecondWord();</span>
<span class="source-line-no">321</span><span id="line-321">        Item vItem = this.aPlayer.getCurrentRoom().getOneItem(vItemName);</span>
<span class="source-line-no">322</span><span id="line-322">        if(vItem==null){</span>
<span class="source-line-no">323</span><span id="line-323">            this.aGui.println("There is no such item in this room.");</span>
<span class="source-line-no">324</span><span id="line-324">            return;</span>
<span class="source-line-no">325</span><span id="line-325">        }</span>
<span class="source-line-no">326</span><span id="line-326">        if (vItem.getCanBePickedUp() &amp;&amp; this.aPlayer.pickUpItem(vItem, aGui)) {</span>
<span class="source-line-no">327</span><span id="line-327">            this.aPlayer.getCurrentRoom().removeItem(vItemName);</span>
<span class="source-line-no">328</span><span id="line-328">            this.aPlayer.setNbrCmdAddOne();</span>
<span class="source-line-no">329</span><span id="line-329">            this.limiteCmd();</span>
<span class="source-line-no">330</span><span id="line-330">        } else if (!vItem.getCanBePickedUp()) {</span>
<span class="source-line-no">331</span><span id="line-331">            this.aGui.println(vItemName + " cannot be picked up.");</span>
<span class="source-line-no">332</span><span id="line-332">        }</span>
<span class="source-line-no">333</span><span id="line-333">    }</span>
<span class="source-line-no">334</span><span id="line-334"></span>
<span class="source-line-no">335</span><span id="line-335">    /**</span>
<span class="source-line-no">336</span><span id="line-336">     * Lacher un objet.</span>
<span class="source-line-no">337</span><span id="line-337">     * @param pCmd commande a traiter</span>
<span class="source-line-no">338</span><span id="line-338">     */</span>
<span class="source-line-no">339</span><span id="line-339">    private void drop(final Command pCmd){</span>
<span class="source-line-no">340</span><span id="line-340">        if (!pCmd.hasSecondWord()) {</span>
<span class="source-line-no">341</span><span id="line-341">            this.aGui.println("Drop what?");</span>
<span class="source-line-no">342</span><span id="line-342">            return;</span>
<span class="source-line-no">343</span><span id="line-343">        }</span>
<span class="source-line-no">344</span><span id="line-344">        String vItemName = pCmd.getSecondWord();</span>
<span class="source-line-no">345</span><span id="line-345">        Item vItem = this.aPlayer.getOneItem(vItemName);</span>
<span class="source-line-no">346</span><span id="line-346">        if(vItem==null){</span>
<span class="source-line-no">347</span><span id="line-347">            this.aGui.println("You don't have this item in your inventory.");</span>
<span class="source-line-no">348</span><span id="line-348">            return;</span>
<span class="source-line-no">349</span><span id="line-349">        }</span>
<span class="source-line-no">350</span><span id="line-350">        this.aPlayer.dropItem(vItemName, aGui);</span>
<span class="source-line-no">351</span><span id="line-351">        this.aPlayer.getCurrentRoom().addItem(vItem);</span>
<span class="source-line-no">352</span><span id="line-352">        this.aPlayer.setNbrCmdAddOne();</span>
<span class="source-line-no">353</span><span id="line-353">        this.limiteCmd();</span>
<span class="source-line-no">354</span><span id="line-354">    }</span>
<span class="source-line-no">355</span><span id="line-355"></span>
<span class="source-line-no">356</span><span id="line-356">    /**</span>
<span class="source-line-no">357</span><span id="line-357">     * Afficher les objets dans joueur.</span>
<span class="source-line-no">358</span><span id="line-358">     * @param pCmd commande a traiter </span>
<span class="source-line-no">359</span><span id="line-359">     */</span>
<span class="source-line-no">360</span><span id="line-360">    private void items(final Command pCmd){</span>
<span class="source-line-no">361</span><span id="line-361">        if (pCmd.hasSecondWord()) {</span>
<span class="source-line-no">362</span><span id="line-362">            this.aGui.println("Items can't be followed by a second word.");</span>
<span class="source-line-no">363</span><span id="line-363">            return; </span>
<span class="source-line-no">364</span><span id="line-364">        }</span>
<span class="source-line-no">365</span><span id="line-365">        this.aGui.println(this.aPlayer.getItemsNames() + "\n" + this.aPlayer.getWeightInfo());</span>
<span class="source-line-no">366</span><span id="line-366">    }</span>
<span class="source-line-no">367</span><span id="line-367"></span>
<span class="source-line-no">368</span><span id="line-368">    /**</span>
<span class="source-line-no">369</span><span id="line-369">     * @return true si le joueur a atteint le nombre maximum de commandes, false</span>
<span class="source-line-no">370</span><span id="line-370">     *         sinon</span>
<span class="source-line-no">371</span><span id="line-371">     */</span>
<span class="source-line-no">372</span><span id="line-372">    private boolean limiteCmd() {</span>
<span class="source-line-no">373</span><span id="line-373">        if (this.aPlayer.getNbrCmd() &gt;= MAXNBRCMD) {</span>
<span class="source-line-no">374</span><span id="line-374">            this.aGui.println("Game Over! You have reached the limit of "+MAXNBRCMD+" commands.");</span>
<span class="source-line-no">375</span><span id="line-375">            this.aGui.enable(false);</span>
<span class="source-line-no">376</span><span id="line-376">            return true;</span>
<span class="source-line-no">377</span><span id="line-377">        } else if (MAXNBRCMD - this.aPlayer.getNbrCmd() &lt; 6) {</span>
<span class="source-line-no">378</span><span id="line-378">            this.aGui.println("Attention! You have only " + (MAXNBRCMD - this.aPlayer.getNbrCmd()) + " commands left.");</span>
<span class="source-line-no">379</span><span id="line-379">        }</span>
<span class="source-line-no">380</span><span id="line-380">        return false;</span>
<span class="source-line-no">381</span><span id="line-381">    }</span>
<span class="source-line-no">382</span><span id="line-382">}</span>




























































</pre>
</div>
</main>
</body>
</html>
